<!DOCTYPE html>
<html>

<head>
    <title>
        博客首页
    </title>
    <link rel='stylesheet' href='/stylesheets/style.css' />
    <link rel="stylesheet" href="/stylesheets/bootstrap.min.css">
    <script src="/javascripts/jquery.min.js"></script>
    <script src="/javascripts/bootstrap.min.js"></script>
    <style>
        table {
            visibility:hidden;
        }
        table * {
            text-align: center;
        }
        table td{
            padding:5px 0;
            border:1px solid #ddd;
        }
    </style>
</head>

<body>
    <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
        <div class="container">
            <a class="navbar-brand" href="#">用户管理</a>
            <p class="navbar-text">欢迎
                <% if(isAdmin) { %>
                <%= admin %>
                <% } %>
                管理员来到博客网
            </p>
            <ul class="nav navbar-nav">
                <li class="active">
                    <a href="/">用户首页</a>
                </li>
            </ul>

            <form class="navbar-form pull-left">
                <input type="text" class="form-control" style="width: 200px;">
                <button type="submit" class="btn btn-default">搜索用户</button>
            </form>

            <ul class="nav navbar-nav pull-right">
                <li class="">
                    <a href="/layout">注销</a>
                </li>
            </ul>
        </div>
    </nav>

    <div class="container" style="padding-top:20px">
        <div class="row">
            <div class="col-md-2">
                <div class="list-group text-center">
                    <a href="#" class="list-group-item active" id="common">普通用户管理</a>
                    <a href="#" class="list-group-item" id="vip">VIP用户管理</a>
                    <a href="#" class="list-group-item" id="admin">Admin用户管理</a>
                    <a href="#" class="list-group-item" id="blog">博客管理</a>
                </div>
            </div>
            <div class="col-md-6">

                <table class="table table-bordered table-hover" id="commonusers">
                    <tr>
                        <th>普通用户</th>
                        <th>密码</th>
                        <th>操作</th>
                    </tr>
                    <tr>
                        <td>
                            <input type="text" class="form-control">
                        </td>
                        <td>
                            <input type="text" class="form-control">
                        </td>
                        <td>
                            <button type="button" class="btn btn-primary">添加</button>
                        </td>
                    </tr>
                </table>
                <table class="table table-bordered table-hover" id="vipusers">
                    <tr>
                        <th>VIP用户</th>
                        <th>密码</th>
                        <th>操作</th>
                    </tr>
                </table>
                <table class="table table-bordered table-hover" id="adminusers">
                    <tr>
                        <th>Admin用户</th>
                        <th>密码</th>
                        <th>操作</th>
                    </tr>
                </table>
            </div>
            <div class="col-md-4">


                <div class="panel panel-info">
                    <div class="panel-heading">
                        <h3 class="panel-title">Panel title</h3>
                    </div>
                    <div class="panel-body">
                        Panel content
                    </div>
                    <div class="panel-footer">
                        pannel footer
                    </div>
                </div>


            </div>
        </div>
    </div>

    <script>
        $(function () {
            $.get("/users/", function (data) {
                data.common.forEach(function (item) {
                    var common =
                        `
                    <tr>
                        <td>${item.username}</td>
                        <td>${item.password}</td>
                        <td>
                            <button data-id="${item.username}" data-user="users" type="button" class="btn btn-danger" >删除</button>
                        </td>
                    </tr>
                    `;
                    $("#commonusers").append(common);
                    $("#commonusers").css("visibility", "visible");
                });
                data.admin.forEach(function (item) {
                    var admin =
                        `
                    <tr>
                        <td>${item.username}</td>
                        <td>${item.password}</td>
                        <td>
                            <button data-id="${item.username}" data-user="admin" type="button" class="btn btn-danger">删除</button>
                        </td>
                    </tr>
                    `;
                    $("#adminusers").append(admin);
                });
                data.vip.forEach(function (item) {
                    var vip =
                        `
                    <tr>
                        <td>${item.username}</td>
                        <td>${item.password}</td>
                        <td>
                            <button data-id="${item.username}" data-user="vip" type="button" class="btn btn-danger">删除</button>
                        </td>
                    </tr>
                    `;
                    $("#vipusers").append(vip);
                });

            });
            $("#common").on("click", function () {
                $("#commonusers").show().css("visibility", "visible").siblings().hide();
                $(this).addClass("active").siblings().removeClass("active");
            });
            $("#vip").on("click", function () {
                $("#vipusers").show().css("visibility", "visible").siblings().hide();
                $(this).addClass("active").siblings().removeClass("active");
            });
            $("#admin").on("click", function () {
                $("#adminusers").show().css("visibility", "visible").siblings().hide();
                $(this).addClass("active").siblings().removeClass("active");
            });
            $("#blog").on("click", function () {
                $(this).addClass("active").siblings().removeClass("active");
            });
            //删除
            $(document).on("click", "button.btn-danger", function () {
                $(this).parent().parent().remove();
                $.post("/users/delete", {
                    col: $(this).attr("data-user"),
                    username: $(this).attr("data-id"),
                }, function (data) {
                    if (data == 1) {
                        alert("删除成功");
                    } else {
                        alert("删除失败");
                    }
                });
            })
        });
    </script>

</body>

</html>